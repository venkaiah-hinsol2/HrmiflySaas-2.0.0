[phases.setup]
nixPkgs = [
  "php",
  "phpPackages.composer",
  "phpExtensions.mbstring",
  "phpExtensions.pdo",
  "phpExtensions.pdo_mysql",
  "phpExtensions.tokenizer",
  "phpExtensions.openssl",
  "phpExtensions.curl",
  "phpExtensions.fileinfo"
]

[phases.install]
cmds = [
  "composer install --no-interaction --prefer-dist --optimize-autoloader"
]

[phases.build]
cmds = [
  # Create .env file
  "cp .env.example .env || true",
  # Generate key
  "php artisan key:generate --force || true",
  # Link storage
  "php artisan storage:link || true"
]

[start]
cmd = "php artisan serve --host=0.0.0.0 --port=80"

